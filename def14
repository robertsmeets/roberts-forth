HEXROM: [ 0 STATE ! ; IMMEDIATE: ] 1 STATE ! ; IMMEDIATE: VARIABLE CREATE 2 ALLOT ;: DO COMPILE (DO) HERE ; IMMEDIATE: LOOP COMPILE (LOOP) 4C C, , ; IMMEDIATE: AGAIN 4C C, , ; IMMEDIATE: UNTIL COMPILE 0BRANCH 4C C, , ; IMMEDIATE: +LOOP COMPILE (+LOOP) 4C C, , ; IMMEDIATE: IF COMPILE 0BRANCH 4C C, HERE 0 , ; IMMEDIATE: THEN HERE SWAP ! ; IMMEDIATE: ELSE 4C C, 0 , HERE SWAP ! HERE 2- ; IMMEDIATE: WHILE [COMPILE] IF ; IMMEDIATE: REPEAT 4C C, SWAP , [COMPILE] THEN ; IMMEDIATE: 2DROP DROP DROP ;: \ ;: ERRDEF CR CR TYPE CR *EXEC \ ;: BR> FIND ERVEK ! ;ER> ERRDEF: MOVE 2* CMOVE ;DECIMAL: ASCII 32 WORD 1+ C@ STATE @ IF [COMPILE] LITERAL THEN ; IMMEDIATE: ( ASCII ) WORD DROP ; IMMEDIATE: COUNT DUP C@ SWAP 1+ SWAP ;: -ROT ROT ROT ;: FILL >R OVER + SWAP DO J I C! LOOP R> DROP ;: CONV ( cijfer --- getal ; zet ascii om in waardeDUP ASCII A 1- > IF [ ASCII A 10 - ] LITERALELSE ASCII 0 - THEN ;: PAK ( --- getal ; pak het volgende als hex getal )32 WORD COUNT 2 - IF ." Geen 2-cijferig hex getal" ABORT THENDUP C@ CONV 16 * SWAP 1+ C@ CONV + ;: PAK4 ( --- getal ; pak het volgende als 4cijferig hex getal )32 WORD COUNT 4 - IF ." Geen 4-cijferig hex getal" ABORT THEN0 4 0 DO 16 * SWAP DUP I + C@ CONV ROT + LOOP SWAP DROP ;HEX: LDA# PAK A9 C, C, ; IMMEDIATE: LDX# PAK A2 C, C, ; IMMEDIATE: LDY# PAK AO C, C, ; IMMEDIATE: JSR PAK4 20 C, , ; IMMEDIATE560 CONSTANT FARRAY565 CONSTANT FSET: FSC FARRAY FSET @ + ;: FS@ FSC C@ ;: FS! FSC C! ;: FSET! FSET ! ;: FO 0 FSET! ;: Fl 1 FSET! ;: F2 2 FSET! ;: F3 3 FSET! ;: F4 4 FSET! ;F0FFCE CONSTANT OSFINDFFDA CONSTANT OSARGS60 CONSTANT OPAGEDECIMAL: OPEN 32 WORD COUNT OVER + 13 SWAP C!SWAP OSFIND CALL FS! DROP ;HEX: OPENOUT 80 OPEN ;: OPENIN 40 OPEN ;: OPENUP CO OPEN ;: FS@256* FS@ 100 * ;: BPUT FS@256* SWAP FFD4 CALL 2DROP ;: BGET FS@256* OQ FFD/7 CALL SWAP DROP ,;: CLOSER 0 OSFIND CALL 2DROP ;: CLOSE FS@256* CLOSER ;: CLOSEO OQ CLOSER ;: ARGS OSARGS CALL 2DROP ;: PTR> FS@256* OPAGE + 0 ARGS OPAGE 2+ @ OPAGE @ ;: >PTR OPAGE ! OPAGE 2+ ! FS@256* OPAGE + 1 ARGS ;: EXT FS@256* OPAGE + 2 ARGS OPAGE 2+ @ OPAGE @ ;: EOF FS@ 1 21E @ CALL DROP 1 AND ;: ID. DUP C@ 7F AND SWAP 1+ SWAP TYPE ;: >NAME 6 - DUP >R 0 >R BEGIN R> DROP DUP R@ - -82 > >R DUP DUP C@7F AND + RR@ = NOT R@ AND WHILE 1- REPEATR> NOT R> DROP IF ." >NAME : Geen naam gevonden" CR ABORT THEN ;: >BODY 3 + ;: ['] COMPILE ' ; IMMEDIATE: NIETS ; 0 , ( --- ; doe niets ; 0, is nodig om evt. te herdefinieren ): CODE } ( --- ; voegt het volgende woord in invoersliert ) | ( met lege inhoud toe aan woordenschat ): VEKTOR ( --- ; maakt een vektor met naam uit invoersliert ) ; ( die wijst naar NIETS )CODE.4C C, [ FIND NIETS ] LITERAL , ;: MAAK ( --- ; herdefinieer woord uit invoersliert als ) ( 2e woord uit invoersliert )FIND DUP 4C SWAP C! 1+ FIND SWAP ! ; |: COMPVEK ( --- ; tijdens vertalen: vertaal het woord waar ) ( de vektor, genoemd in de invoersliert naar wijst )OFIND 1+ @ 20 C, , ; IMMEDIATE: MAAKVEK ( --- ; de waarde van de eerste vektor in de invoersliert ) ( wordt gelijk aan de waarde van de tweede )FIND 1+ FIND 1+ @ SWAP ! ;FFF1 CONSTANT OSWORD: >TIME ( lb 2b 2b --- ; zet interne klok )PAD ! PAD 2+ ! PAD 4 + C! PAD 2 OSWORD CALL 2DROP ;: TIME> ( --- lb 2b 2b ; lees interne klok ).PAD 1 OSWORD CALL 2DROP PAD 4 + C@ PAD 2+ @ PAD @ ;: (")R> 1+ DUP DUP C@ + >R ;: INKLUDEER ( adr --- ; zet getelde string op HERE )DUP C@ 1+ SWAP OVER HERE SWAP CMOVE ALLOT ;: " ( --- adr ; laat bij uitvoering het adres van een ) ( getelde string staan; anders = ASCII " WORD )ASCII " WORD STATE @ IF COMPILE (") INKLUDEER THEN ,;IMMEDIATE: ERROR" ASCII " WORD 0 C, INKLUDEER 0 C, ; IMMEDIATEDECIMAL: OPSTART CR CR ." Robert's Forth" CR CR START ;3 MODE WORDSSAVE FORTH